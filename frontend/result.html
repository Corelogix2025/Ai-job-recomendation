<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Resume Analysis Result</title>
    <link rel="stylesheet" href="style.css">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>

<body>

    <div class="result-layout">

        <!-- LEFT PANEL -->
        <div class="left-panel">
            <h2>Overall Resume Score</h2>

            <!-- Battery Score -->
            <div class="battery">
                <div class="battery-body">
                    <div class="battery-fill" id="batteryFill"></div>
                </div>
                <div class="battery-cap"></div>
                <div class="battery-text" id="batteryText">0%</div>
            </div>

            <!-- Suggestions -->
            <div class="overall-suggestions">
                <h3>Improvement Suggestions</h3>
                <ul id="suggestionsList"></ul>
            </div>
        </div>

        <!-- RIGHT PANEL -->
        <div class="right-panel">
            <h2>Top Job Matches</h2>
            <div id="jobsContainer"></div>
        </div>

    </div>

    <script>
        /* ðŸ”¥ FIREBASE CONFIG */
        const firebaseConfig = {
            apiKey: "AIzaSyApIFWYjxtL-taAem3ddARVr3kwoe-Bedg",
            authDomain: "ai-job-ba0f5.firebaseapp.com",
            databaseURL: "https://ai-job-ba0f5-default-rtdb.firebaseio.com",
            projectId: "ai-job-ba0f5",
            storageBucket: "ai-job-ba0f5.firebasestorage.app",
            messagingSenderId: "816955655434",
            appId: "1:816955655434:web:5719896ea02674290366f3",
            measurementId: "G-ZV2W9JPVLB"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        /* -----------------------------
           LOAD RESULT DATA
        ----------------------------- */
        const data = JSON.parse(localStorage.getItem("resultData"));

        if (!data) {
            alert("No result data found. Please upload resume again.");
            window.location.href = "index.html";
        }

        /* -----------------------------
           BATTERY SCORE
        ----------------------------- */
        const score = data.resume_score || 0;
        document.getElementById("batteryFill").style.width = score + "%";
        document.getElementById("batteryText").innerText = score + "%";

        /* -----------------------------
           SUGGESTIONS
        ----------------------------- */
        const suggestionsList = document.getElementById("suggestionsList");
        suggestionsList.innerHTML = "";

        data.suggestions.forEach(tip => {
            const li = document.createElement("li");
            li.innerText = tip;
            suggestionsList.appendChild(li);
        });

        /* -----------------------------
           JOB MATCHES
        ----------------------------- */
        const jobsContainer = document.getElementById("jobsContainer");
        jobsContainer.innerHTML = "";

        // Jobs already ranked by backend AI
        data.jobs.forEach((job, index) => {
            const card = document.createElement("div");
            card.className = "job-card";

            card.innerHTML = `
                <div class="job-title">${index + 1}. ${job.title}</div>
                <div class="match">Job Match: ${job.job_match}%</div>
                <div class="explain">${job.explanation}</div>
                <a class="apply-btn" href="${job.link}" target="_blank">Apply Now</a>
            `;

            jobsContainer.appendChild(card);
        });
    </script>

</body>

</html>